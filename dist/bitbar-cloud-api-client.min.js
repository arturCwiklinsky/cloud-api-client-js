/* @bitbar/cloud-api-client v0.22.0 | Copyright 2020 (c) SmartBear Software and contributors | .git/blob/master/LICENSE */
!function(e,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s(require("@bitbar/finka"),require("axios"),require("qs")):"function"==typeof define&&define.amd?define(["@bitbar/finka","axios","qs"],s):(e=e||self)["bitbar-cloud-api-client"]=s(e["@bitbar/finka"],e.axios,e.qs)}(this,(function(e,s,t){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t,e();var r;!function(e){e.GET="GET",e.POST="POST",e.DELETE="DELETE"}(r||(r={}));class n{constructor(e){this.stack=[],this.requestConfig={},e instanceof n?(this.root=e.root,Array.isArray(e.stack)&&this.push(...e.stack),null!=e.requestConfig&&this.setRequestConfig(e.requestConfig)):this.root=e}push(...e){for(const s of e)this.stack.push(s);return this}pop(){return this.stack.pop(),this}toUrl(e=!1){let s="/"+this.stack.join("/");return e&&(s=this.root.axiosConfig.baseURL+s),s}setRequestConfig(e){return Object.deepAssign(this.requestConfig,e),this}removeRequestConfig(e){return delete this.requestConfig[e],this}headers(e){const s={};for(const t in e){s[t.replace(/(?:^|-)([a-z])/g,(e=>e.toUpperCase()))]=e[t]}return this.setRequestConfig({headers:s})}method(e){const s=e.toLocaleUpperCase();if(!r[s])throw new Error(`Method '${s}' is not allowed! You can use: ${Object.keys(r).join(", ")}`);return this.setRequestConfig({method:s})}get(){return this.method("GET")}post(){return this.method("POST")}params(e){return Object.deepAssign(this.requestConfig,{params:e}),this}getParams(){return null==this.requestConfig.params?{}:this.requestConfig.params}removeParam(e){return delete this.requestConfig.params[e],this}data(e){return Object.deepAssign(this.requestConfig,{data:e}),this}jsonData(e){return this.headers({"Content-Type":"application/json"}).data(e),this}formData(e){return this.headers({"Content-Type":"multipart/form-data"}).data(e),this}paramsSerializer(e){return t.stringify(e,{arrayFormat:"brackets"})}send(){const e=Object.deepAssign({},this.requestConfig,{url:"/"+this.stack.join("/")});return null==e.headers&&(e.headers={}),null==e.headers["Content-Type"]&&(e.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),"POST"===e.method&&e.headers["Content-Type"].startsWith("application/x-www-form-urlencoded")&&null!=e.data&&(e.data=t.stringify(e.data)),e.params&&(e.paramsSerializer=this.paramsSerializer),this.root.axios.request(e)}}class i{constructor(e,s,t){this.name=e,this.value=s,this.operand=t}}class u{constructor(){this.filters=[]}add(e,s,t,r=!1){if(0===(s=Array.wrap(s)).length)return this;for(let e=0;e<s.length;e++){const t=s[e];"object"==typeof t&&t instanceof Date&&(s[e]=t.getTime())}if(r)for(const e of s);return t.endsWith("ornull")&&0===s.length&&(t="isnull"),this.filters.push(new i(e,s,t)),this}gt(e,s){return this.add(e,s,"gt")}lt(e,s){return this.add(e,s,"lt")}after(e,s){return this.add(e,s,"after",!0)}afterorequal(e,s){return this.add(e,s,"afterorequal",!0)}before(e,s){return this.add(e,s,"before",!0)}beforeorequal(e,s){return this.add(e,s,"beforeorequal",!0)}on(e,s){return this.add(e,s,"on")}eq(e,s){return this.add(e,s,"eq")}contains(e,s){return this.add(e,s,"contains")}like(e,s){return this.add(e,s,"like")}isnull(e){return this.add(e,void 0,"isnull")}in(e,s){return this.add(e,s,"in",!0)}notin(e,s){return this.add(e,s,"notin",!0)}raw(e){const s=Array.wrap(e);for(const e of s){if(!this.isFilterPart(e))throw new SyntaxError(`Filter ${e} has invalid syntax`);this.filters.push(e)}}isFilterPart(e){return/^[a-zA-Z0-9.]{2,12}_(?:isnull$|(?:gt|lt|(?:after|before)(?:orequal)?|on|eq|contains|like|(?:not)?in)_)/.test(e)}toString(){const e=[];let s,t;for(const r of this.filters)"string"==typeof r?s=r:(t="",(r.value.length>1||void 0!==r.value[0])&&(t="_"+r.value.join("|")),s=`${r.name}_${r.operand}${t}`),e.push(s);return e.join(";")}}var o;!function(e){e.asc="a",e.desc="d"}(o||(o={}));class h extends n{create(e){return this.post().data(e).send()}sort(e,s=o.asc){return this.params({sort:`${e}_${s}`})}limit(e=20){if(!Number.isNatural(e))throw new Error(`Limit '${e}' is invalid!`);return this.params({limit:e})}getLimit(){const e=this.getParams();return null==e.limit?20:e.limit}noLimit(){return this.limit(0)}offset(e=0){if(!Number.isNatural(e))throw new Error(`Offset '${e}' is invalid!`);return this.params({offset:e})}between(e,s){if(!Number.isNatural(e))throw new Error(`From '${e}' is invalid!`);if(!Number.isNatural(s))throw new Error(`To '${s}' is invalid!`);return this.params({offset:e,limit:s-e+1})}only(e){if(!Number.isNatural(e))throw new Error(`Index '${e}' is invalid!`);return this.params({offset:e,limit:1})}page(e=1){if(!Number.isNatural(e)||0==e)throw new Error(`Page '${e}' is invalid!`);const s=this.getLimit(),t=(e-1)*s;return this.params({offset:t,limit:s})}search(e){if("string"!=typeof e)throw new Error("Search query must be a string!");return this.params({search:e})}filter(e){const s=e instanceof u;if("string"!=typeof e&&!s)throw new Error("Filter must be either string or instance of FilterBuilder");return s&&(e=e.toString()),this.params({filter:e})}}h.prototype.all=h.prototype.noLimit,h.prototype.cut=h.prototype.between;class a extends n{delete(){return this.method("DELETE")}}class c extends h{constructor(e){super(e),this.push("devices")}filters(){return new a(this).push("filters")}cleanupConfigurations(){return new h(this).push("cleanup-configurations")}cleanupConfiguration(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("cleanup-configurations",e)}}class l extends h{constructor(e){super(e),this.push("users")}activate(){return new a(this).push("activate")}recoveries(){return new a(this).push("recoveries")}passwordRecovery(){return new a(this).push("password-recovery")}resetApiKey(){return new a(this).push("reset-api-key")}validateVatId(){return new a(this).push("validateVatId")}}class p extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("additional-users",s)}resendActivation(){return new a(this).push("resend-activation")}}class w extends a{constructor(e,s){super(e),s?this.push("accounts",s):this.push("account")}preferences(){return new a(this).push("preferences")}concurrencyStatus(){return new a(this).push("concurrency-status")}roles(){return new h(this).push("roles")}role(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("roles",e)}additionalUsers(){return new h(this).push("additional-users")}additionalUser(e){return new p(this,e)}}class d extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("billing-periods",s)}receipt(){return new a(this).push("receipt").setRequestConfig({responseType:"arraybuffer"})}}class f extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("builds",s)}abort(){return new a(this).push("abort")}outputFiles(){return new h(this).push("output-file-set","files")}}class g extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("jobs",s)}builds(){return new h(this).push("builds")}build(e){return new f(this,e)}}class m extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("device-groups",s)}devices(){return new h(this).push("devices")}device(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("devices",e)}selectors(){return new h(this).push("selectors")}selector(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("selectors",e)}}class b extends a{constructor(e){super(e),this.push("input-file-set")}files(){return new h(this).push("files")}filesZip(){return new a(this).push("files.zip")}}const v=new u;v.eq("state","READY"),v.notin("mimetype",["image/png","image/jpg","image/jpeg","image/webp","image/gif","video/mp4","video/avi","video/webm","video/ogg","video/mpeg"]);class y extends a{constructor(e){super(e),this.push("output-file-set")}files(){return new h(this).push("files")}filesZip(){return new a(this).push("files.zip")}screenshots(){return new h(this).push("screenshots")}screenshot(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("screenshots",e)}screenshotFile(e){this.screenshot(e).push("file")}videos(){this.files().params({filter:"s_state_eq_READY",tag:["video"]})}nonMediaFiles(){return this.files().filter(v)}}class E extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("device-sessions",s)}clusterLogs(){return new a(this).push("cluster-logs")}dataAvailability(){return new a(this).push("data-availability")}fixturesZip(){return new a(this).push("fixtures.zip")}junitXml(){return new a(this).push("junit.xml")}logs(){return new a(this).push("logs")}performance(){return new a(this).push("performance")}release(){return new a(this).push("release")}resultDataZip(){return new a(this).push("result-data.zip")}screenshots(){return new h(this).push("screenshots")}screenshot(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("screenshots",e)}steps(){return new h(this).push("steps")}step(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("steps",e)}currentStep(){return this.step("current")}testCaseRuns(){return new h(this).push("test-case-runs")}retry(){return new a(this).push("retry").post()}input(){return new b(this)}output(){return new y(this)}videos(){return this.output().videos()}connections(){return new h(this).push("connections")}}class x extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("runs",s)}config(){return new a(this).push("config")}deviceSessions(){return new h(this).push("device-sessions")}deviceSession(e){return new E(this,e)}steps(){return new h(this).push("steps")}files(){return new h(this).push("files")}filesZip(){return new a(this).push("files.zip")}tags(){return new h(this).push("tags")}tag(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("tags",e)}}class R extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("projects",s)}runs(){return new h(this).push("runs")}run(e){return new x(this,e)}runsExtended(){return new h(this).push("runs-extended")}runExtended(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("runs-extended",e)}files(){return new h(this).push("files")}filesZip(){return new a(this).push("files.zip")}sharings(){return new h(this).push("sharings")}sharing(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("sharings",e)}}class D extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("files",s)}file(){return new a(this).push("file")}icon(){return new a(this).push("icon")}tags(){return new h(this).push("tags")}}class I extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("notifications",s)}test(){return new a(this).push("test")}}class q extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("access-groups",s)}users(){return new h(this).push("users")}user(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("users",e)}resources(){return new h(this).push("resources")}resource(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("resources",e)}}class C extends h{constructor(e){super(e),this.push("device-time")}reserved(){return new h(this).push("reserved")}used(){return new h(this).push("used")}}class j extends h{constructor(e){super(e),this.push("files")}upload(e){let s;if(!globalThis.isNodeJs)throw new Error("Not supported yet!");{const t=require("fs");s=new(require("form-data")),s.append("file",t.createReadStream(e.dir+"/"+e.filename),{filename:e.filename})}this.post().headers(s.getHeaders()).data(s)}}class S extends h{constructor(e){super(e),this.push("purchased")}}class T extends h{constructor(e){super(e),this.push("services")}purchased(){return new S(this)}available(){this.push("available")}}class k extends h{constructor(e){super(e),this.push("runs")}config(){return new a(this).push("config")}}class A extends h{constructor(e){super(e),this.push("notifications")}scopes(){return new h(this).push("scopes")}channels(){return new h(this).push("channels")}}class U extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");if(super(e),"me"===s)this.push("me");else{if("number"!=typeof s)throw new TypeError("id is not a number");this.push("users",s)}}account(){return new w(this)}deviceTime(){return new C(this)}deviceTimeSummary(){return new h(this).push("device-time-summary")}services(){return new T(this)}service(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("services",e)}accountServiceBillingPeriod(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("account-services",e,"billing-period")}billingPeriods(){return new h(this).push("billing-periods")}billingPeriod(e){return new d(this,e)}jobs(){return new h(this).push("jobs")}job(e){return new g(this,e)}deviceGroups(){return new h(this).push("device-groups")}deviceGroup(e){return new m(this,e)}deviceSessions(){return new h(this).push("device-sessions")}deviceSession(e){return new E(this,e)}projects(){return new h(this).push("projects")}project(e){return new R(this,e)}files(){return new j(this)}file(e){return new D(this,e)}runs(){return new k(this)}availableBuildExecutors(){return new h(this).push("available-build-executors")}availableFrameworks(){return new h(this).push("available-frameworks")}resetApiKey(){return new a(this).push("reset-api-key")}restore(){return new a(this).push("restore")}accountAdditionalUsers(){return new h(this).push("account","additional-users")}accountAdditionalUser(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("account","additional-users",e)}feedback(){return new a(this).push("feedback")}notifications(){return new A(this)}notification(e){return new I(this,e)}receipts(){return new h(this).push("receipts")}preferences(){return new a(this).push("preferences")}uiPreferences(){return new a(this).push("ui-preferences")}integrations(){return new h(this).push("integrations")}integration(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("integrations",e)}deviceUsage(){return new h(this).push("device-usage")}statistics(){return new h(this).push("statistics")}deviceStatistics(){return new h(this).push("device-statistics")}accessGroups(){return new h(this).push("access-groups")}accessGroup(e){return new q(this,e)}}class P extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("devices",s)}properties(){return new h(this).push("properties")}}class L extends a{constructor(e){super(e),this.push("user-sessions")}login(e){return new a(this).push("login").post().data(e)}logout(){return new a(this).push("logout").post()}sso(e){return new a(this).push(e+"-login")}portalLogin(){return new a(this).push("portal-login").post()}}class $ extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("clusters",s)}devices(){return new h(this).push("devices")}}class z extends a{constructor(e){super(e),this.push("device-time")}countSessionReport(){return new h(this).push("count-session-report")}stepTimeReport(){return new h(this).push("step-time-report")}}class N extends x{abort(){return new a(this).push("abort").post()}retry(e){const s=new a(this).push("retry").setRequestConfig({timeout:0}).post();return null!=e&&s.params({deviceRunIds:e}),s}changeBillable(){return new a(this).push("changebillable")}changePriority(){return new a(this).push("changepriority")}screenshotNames(){return new h(this).push("screenshot-names")}screenshots(){return new h(this).push("screenshots")}dataAvailability(){return new h(this).push("data-availability")}buildLogsZip(e){const s=new a(this).push("build-logs.zip");return null!=e&&s.params({deviceRunIds:e}),s}logsZip(){return new a(this).push("logs.zip")}performanceZip(){return new a(this).push("performance.zip")}screenshotsZip(){return new a(this).push("screenshots.zip")}}class O extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("admin"),this.push("devices",s)}queue(){return new h(this).push("queue")}}class F extends a{constructor(e,s){if(null==s)throw new Error("Resource ID cannot be null!");super(e),this.push("device-sessions",s)}changeBillable(){const e=new a(this);return e.stack.splice(e.stack.length-2,0,"admin"),e.push("changebillable").post()}connections(){return new h(this).push("connections")}connection(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("connections",e)}input(){return new b(this)}output(){return new y(this)}release(){return new a(this).push("release").post()}screenshots(){return new h(this).push("screenshots")}screenshot(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("screenshots",e)}steps(){return new h(this).push("steps")}step(e){if(null==e)throw new Error("Resource ID cannot be null!");return new a(this).push("steps",e)}currentStep(){return this.step("current")}testCaseRuns(){return new h(this).push("test-case-runs")}}class G extends a{constructor(e){super(e)}withAdmin(){return new a(this).push("admin")}clusters(){return new h(this).push("clusters")}cluster(e){return new $(this,e)}devices(){return new h(this).push("admin","devices")}device(e){return new O(this,e)}deviceModels(){return new h(this).push("admin","device-models")}deviceModel(e){return new a(this).push("admin","device-models",e)}deviceSessions(){return new h(this).push("admin","device-sessions")}deviceSession(e){return new F(this,e)}deviceStatuses(){return new h(this).push("device-status")}deviceTime(){return new z(this.withAdmin())}interactiveQueue(){return new h(this).push("admin","interactive-queue")}files(){return new h(this).push("files")}file(e){return new D(this,e)}overview(){return new a(this).push("admin","overview")}projects(){return new h(this).push("projects")}project(e){return new R(this,e)}runs(){return new h(this).push("admin","runs")}run(e){return new N(this,e)}users(){return new h(this).push("users")}}globalThis.isNodeJs&&(s.defaults.headers.common["User-Agent"]="Bitbar Cloud API Client for JavaScript v0.22.0"),s.defaults.maxContentLength=1073741824;return{API:class{constructor(e){if(null==e)throw new Error("config cannot be empty");if(this.config=e,this.axiosConfig={},null==this.config.cloudUrl)throw new TypeError("cloudUrl cannot be empty");if("string"!=typeof this.config.cloudUrl)throw new TypeError("cloudUrl must be a string");if(!/^https?:\/\/.{2,}/.test(this.config.cloudUrl))throw new Error("cloudUrl doesn't look like a URL");if(this.axiosConfig.baseURL=this.config.cloudUrl.replace(/\/+$/,"")+"/api",this.config.v2=!!this.config.v2,this.config.v2&&(this.axiosConfig.baseURL+="/v2"),this.config.apiKey){if("string"!=typeof this.config.apiKey)throw new TypeError("apiKey must be a string");if(!/^[A-Za-z0-9]{32}$/.test(this.config.apiKey))throw new Error("apiKey is in the wrong format");this.axiosConfig.auth={username:this.config.apiKey,password:""}}this.axios=s.create(this.axiosConfig)}userSession(){return new L(this)}user(e){return new U(this,e)}users(){return new l(this)}me(){return this.user("me")}admin(){return new G(this)}devices(){return new c(this)}device(e){return new P(this,e)}deviceGroups(){return new h(this).push("device-groups")}deviceGroup(e){return new m(this,e)}labelGroups(){return new h(this).push("label-groups")}deviceStatistics(){return new h(this).push("device-statistics")}accessGroups(){return new h(this).push("access-groups")}accessGroup(e){return new q(this,e)}account(e){return new w(this,e)}},FilterBuilder:u}}));
//# sourceMappingURL=bitbar-cloud-api-client.min.js.map
